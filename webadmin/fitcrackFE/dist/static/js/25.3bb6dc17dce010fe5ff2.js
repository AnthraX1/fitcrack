webpackJsonp([25],{487:function(e,t,a){"use strict";function n(e){a(915)}Object.defineProperty(t,"__esModule",{value:!0});var i=a(679),s=a(917),r=a(39),o=n,l=r(i.a,s.a,!1,o,"data-v-cfb03af8",null);t.default=l.exports},679:function(e,t,a){"use strict";var n=a(21),i=a.n(n),s=a(22),r=a.n(s);t.a={name:"UsersView",data:function(){return{newRoleName:null,addingRole:!1,roleDialog:!1,newPassword:null,newUsername:null,newEmail:null,newUserRoleID:null,editingUser:!1,editingUserId:null,editDialog:!1,addingUser:!1,userDialog:!1,users:[],totalItems:0,pagination:{},loading:!0,headers:[{text:"Name",align:"start",value:"name"},{text:"Manage users",value:"MANAGE_USERS",align:"start"},{text:"Add new job",value:"ADD_NEW_JOB",align:"start"},{text:"View all jobs",value:"VIEW_ALL_JOBS",align:"start"},{text:"Edit all jobs",value:"EDIT_ALL_JOBS",align:"start"},{text:"Operate all jobs",value:"OPERATE_ALL_JOBS",align:"start"},{text:"Add new dictionaries",value:"UPLOAD_DICTIONARIES",align:"start"},{text:"",value:"id",align:"end"}],userRoles:[],validEditUserForm:!0,validNewUserForm:!0,emailRules:[function(e){return/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(e)}],usernameRules:[function(e){return/^\w+.*$/.test(e)}]}},created:function(){this.loadUsers(),this.loadRoles()},methods:{loadUsers:function(){var e=this;this.axios.get(this.$serverAddr+"/user/").then(function(t){e.users=t.data.items})},loadRoles:function(){var e=this;this.loading=!0,this.axios.get(this.$serverAddr+"/user/role").then(function(t){e.userRoles=t.data.items,e.loading=!1})},updateUserRole:function(e,t){var a=this;this.axios.post(this.$serverAddr+"/user/role",{user_id:t,role_id:e}).then(function(e){a.$store.dispatch("refreshUser"),a.$store.dispatch("binInterface/load"),console.log(e.data),console.log("user role changed")})},roleChange:function(e,t,a){var n=this;this.axios.post(this.$serverAddr+"/user/role/"+t,{key:a,value:e}).then(function(e){n.$store.dispatch("refreshUser"),n.$store.dispatch("binInterface/load"),console.log(e.data),console.log("user role changed")})},addRole:function(){var e=this;this.addingRole=!0,this.axios.post(this.$serverAddr+"/user/role/new",{name:this.newRoleName}).then(function(t){console.log(t.data),e.loadRoles(),e.roleDialog=!1,e.newRoleName="",e.addingRole=!1})},deleteRole:function(e){var t=this;this.axios.delete(this.$serverAddr+"/user/role/"+e).then(function(e){console.log(e.data),t.loadRoles()})},addUser:function(){var e=this;this.addingUser=!0,this.axios.post(this.$serverAddr+"/user/",{username:this.newUsername,mail:this.newEmail,password:this.newPassword,role_id:this.newUserRoleID}).then(function(t){console.log(t.data),e.loadUsers(),e.userDialog=!1,e.addingUser=!1,e.newUsername="",e.newEmail="",e.newPassword="",e.newUserRoleID=""})},editUser:function(e){this.editDialog=!0,this.editingUserId=e},editUserCancel:function(){this.editDialog=!1,this.editingUserId=null},editUserConfirm:function(){var e=this;return r()(i.a.mark(function t(){var a,n,s,r,o;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=function(e){return/^\s*$/.test(e)?null:e},e.editingUser=!0,n=a(e.newUsername),s=a(e.newEmail),r=a(e.newPassword),t.next=7,e.axios.patch(e.$serverAddr+"/user/"+e.editingUserId,{username:n,mail:s,password:r});case 7:o=t.sent,e.editingUser=!1,e.editDialog=!1,e.newUsername="",e.newEmail="",e.newPassword="",e.loadUsers();case 14:case"end":return t.stop()}},t,e)}))()},deleteUser:function(e){var t=this;this.axios.delete(this.$serverAddr+"/user/"+e).then(function(e){console.log(e.data),t.loadUsers()})}}}},915:function(e,t,a){var n=a(916);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a(471)("8c239848",n,!0,{})},916:function(e,t,a){t=e.exports=a(470)(!0),t.push([e.i,".tinyselect[data-v-cfb03af8]{max-width:40ch}.users[data-v-cfb03af8]{margin-top:2em;max-width:850px}h2[data-v-cfb03af8]{padding-bottom:5px;text-align:center}.roleTable[data-v-cfb03af8]{max-width:850px;margin:auto}.width150[data-v-cfb03af8]{min-width:100px}.addBtnCont[data-v-cfb03af8]{text-align:right}.addBtn[data-v-cfb03af8]{display:inline-block;margin-right:0}.loadingOver[data-v-cfb03af8]{position:absolute;top:0;left:0;width:100%;height:100%}.loadingOver .progress[data-v-cfb03af8]{top:0;bottom:0;left:0;right:0;margin:auto;position:absolute}","",{version:3,sources:["/home/runner/work/fitcrack/fitcrack/webadmin/fitcrackFE/src/components/user/manageUsersView.vue"],names:[],mappings:"AACA,6BACE,cAAgB,CACjB,AACD,wBACE,eAAgB,AAChB,eAAiB,CAClB,AACD,oBACE,mBAAoB,AACpB,iBAAmB,CACpB,AACD,4BACE,gBAAiB,AACjB,WAAa,CACd,AACD,2BACE,eAAiB,CAClB,AACD,6BACE,gBAAkB,CACnB,AACD,yBACE,qBAAsB,AACtB,cAAgB,CACjB,AACD,8BACE,kBAAmB,AACnB,MAAO,AACP,OAAQ,AACR,WAAY,AACZ,WAAa,CACd,AACD,wCACE,MAAO,AACP,SAAU,AACV,OAAQ,AACR,QAAS,AACT,YAAa,AACb,iBAAmB,CACpB",file:"manageUsersView.vue",sourcesContent:["\n.tinyselect[data-v-cfb03af8] {\n  max-width: 40ch;\n}\n.users[data-v-cfb03af8] {\n  margin-top: 2em;\n  max-width: 850px;\n}\nh2[data-v-cfb03af8] {\n  padding-bottom: 5px;\n  text-align: center;\n}\n.roleTable[data-v-cfb03af8] {\n  max-width: 850px;\n  margin: auto;\n}\n.width150[data-v-cfb03af8] {\n  min-width: 100px;\n}\n.addBtnCont[data-v-cfb03af8] {\n  text-align: right;\n}\n.addBtn[data-v-cfb03af8] {\n  display: inline-block;\n  margin-right: 0;\n}\n.loadingOver[data-v-cfb03af8] {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n.loadingOver .progress[data-v-cfb03af8] {\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  margin: auto;\n  position: absolute;\n}\n"],sourceRoot:""}])},917:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"users mx-auto mb-5"},[a("h2",[e._v("Users")]),e._v(" "),a("v-card",[a("v-list",{attrs:{"two-line":""}},[e._l(e.users,function(t,n){return[a("v-list-item",{key:n},[a("v-list-item-content",[a("v-list-item-title",[e._v("\n                "+e._s(t.username)+"\n              ")]),e._v(" "),a("v-list-item-subtitle",[e._v(e._s(t.mail))])],1),e._v(" "),a("v-list-item-action",{staticClass:"width150"},[a("v-select",{staticClass:"tinyselect",attrs:{outlined:"","hide-details":"",dense:"","item-text":"name","item-value":"id",items:e.userRoles,label:"Role",value:t.role.id},on:{change:function(a){return e.updateUserRole(a,t.id)}}})],1),e._v(" "),a("v-list-item-action",[a("div",{staticClass:"addBtnCont"},[a("v-btn",{staticClass:"addBtn",attrs:{color:"primary",text:""},on:{click:function(a){return e.editUser(t.id)}}},[e._v("\n                  Edit\n                ")])],1)]),e._v(" "),a("v-list-item-action",[a("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(n){var i=n.on;return[a("v-btn",e._g({staticClass:"mx-0",attrs:{icon:""},on:{click:function(a){return e.deleteUser(t.id)}}},i),[a("v-icon",{attrs:{color:"error"}},[e._v("\n                      close\n                    ")])],1)]}}],null,!0)},[e._v(" "),a("span",[e._v("Delete user")])])],1)],1),e._v(" "),n+1<e.users.length?a("v-divider",{key:n+"d"}):e._e()]})],2)],1),e._v(" "),a("div",{staticClass:"addBtnCont"},[a("v-btn",{staticClass:"addBtn",attrs:{color:"primary",text:""},on:{click:function(t){e.userDialog=!0}}},[e._v("\n        Add user\n      ")])],1)],1),e._v(" "),a("h2",[e._v("User roles")]),e._v(" "),a("div",{staticClass:"roleTable"},[a("v-data-table",{staticClass:"elevation-1 roleTable",attrs:{headers:e.headers,items:e.userRoles,loading:e.loading,"hide-default-footer":"","disable-sort":""},scopedSlots:e._u([{key:"item.MANAGE_USERS",fn:function(t){var n=t.item;return[a("v-checkbox",{attrs:{disabled:1==n.id},on:{change:function(t){return e.roleChange(t,n.id,"MANAGE_USERS")}},model:{value:n.MANAGE_USERS,callback:function(t){e.$set(n,"MANAGE_USERS",t)},expression:"item.MANAGE_USERS"}})]}},{key:"item.ADD_NEW_JOB",fn:function(t){var n=t.item;return[a("v-checkbox",{attrs:{disabled:1==n.id},on:{change:function(t){return e.roleChange(t,n.id,"ADD_NEW_JOB")}},model:{value:n.ADD_NEW_JOB,callback:function(t){e.$set(n,"ADD_NEW_JOB",t)},expression:"item.ADD_NEW_JOB"}})]}},{key:"item.VIEW_ALL_JOBS",fn:function(t){var n=t.item;return[a("v-checkbox",{attrs:{disabled:1==n.id},on:{change:function(t){return e.roleChange(t,n.id,"VIEW_ALL_JOBS")}},model:{value:n.VIEW_ALL_JOBS,callback:function(t){e.$set(n,"VIEW_ALL_JOBS",t)},expression:"item.VIEW_ALL_JOBS"}})]}},{key:"item.EDIT_ALL_JOBS",fn:function(t){var n=t.item;return[a("v-checkbox",{attrs:{disabled:1==n.id},on:{change:function(t){return e.roleChange(t,n.id,"EDIT_ALL_JOBS")}},model:{value:n.EDIT_ALL_JOBS,callback:function(t){e.$set(n,"EDIT_ALL_JOBS",t)},expression:"item.EDIT_ALL_JOBS"}})]}},{key:"item.OPERATE_ALL_JOBS",fn:function(t){var n=t.item;return[a("v-checkbox",{attrs:{disabled:1==n.id},on:{change:function(t){return e.roleChange(t,n.id,"OPERATE_ALL_JOBS")}},model:{value:n.OPERATE_ALL_JOBS,callback:function(t){e.$set(n,"OPERATE_ALL_JOBS",t)},expression:"item.OPERATE_ALL_JOBS"}})]}},{key:"item.UPLOAD_DICTIONARIES",fn:function(t){var n=t.item;return[a("v-checkbox",{attrs:{disabled:1==n.id},on:{change:function(t){return e.roleChange(t,n.id,"UPLOAD_DICTIONARIES")}},model:{value:n.UPLOAD_DICTIONARIES,callback:function(t){e.$set(n,"UPLOAD_DICTIONARIES",t)},expression:"item.UPLOAD_DICTIONARIES"}})]}},{key:"item.id",fn:function(t){var n=t.item;return[a("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({directives:[{name:"show",rawName:"v-show",value:n.id>1,expression:"item.id > 1"}],staticClass:"mx-0",attrs:{icon:""},on:{click:function(t){return e.deleteRole(n.id)}}},i),[a("v-icon",{attrs:{color:"error"}},[e._v("\n                close\n              ")])],1)]}}],null,!0)},[e._v(" "),a("span",[e._v("Delete role")])])]}}])}),e._v(" "),a("div",{staticClass:"addBtnCont"},[a("v-btn",{staticClass:"addBtn",attrs:{color:"primary",text:""},on:{click:function(t){e.roleDialog=!0}}},[e._v("\n        Add role\n      ")])],1)],1),e._v(" "),a("v-dialog",{attrs:{"max-width":"400px"},model:{value:e.roleDialog,callback:function(t){e.roleDialog=t},expression:"roleDialog"}},[a("v-card",[a("v-card-title",[a("h2",[e._v("Add new user role")])]),e._v(" "),a("v-card-text",[a("v-text-field",{attrs:{label:"Role name"},model:{value:e.newRoleName,callback:function(t){e.newRoleName=t},expression:"newRoleName"}})],1),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){t.stopPropagation(),e.roleDialog=!1}}},[e._v("\n          Cancel\n        ")]),e._v(" "),a("v-btn",{attrs:{color:"primary",text:"",disabled:""==e.newRoleName},on:{click:function(t){return t.stopPropagation(),e.addRole(t)}}},[e._v("\n          Add\n        ")])],1),e._v(" "),e.addingRole?a("div",{staticClass:"loadingOver"},[a("v-progress-circular",{staticClass:"progress",attrs:{size:"50",width:3,indeterminate:"",color:"primary"}})],1):e._e()],1)],1),e._v(" "),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.editDialog,callback:function(t){e.editDialog=t},expression:"editDialog"}},[a("v-card",[a("v-card-title",[a("h2",[e._v("Edit user")])]),e._v(" "),a("v-card-text",[a("p",[e._v("\n          All fields are optional. Empty will be left unchanged.\n        ")]),e._v(" "),a("v-form",{ref:"form",attrs:{"lazy-validation":""}},[a("v-text-field",{attrs:{label:"Username",rules:e.usernameRules,counter:10,autocomplete:"off"},model:{value:e.newUsername,callback:function(t){e.newUsername=t},expression:"newUsername"}}),e._v(" "),a("v-text-field",{attrs:{label:"E-mail",rules:e.emailRules,autocomplete:"off"},model:{value:e.newEmail,callback:function(t){e.newEmail=t},expression:"newEmail"}}),e._v(" "),a("p",[e._v("\n            Only change user's password if it's absolutely needed, for example\n            if they forgot. Otherwise, you'll lock them out.\n          ")]),e._v(" "),a("v-text-field",{attrs:{type:"password",label:"New password",autocomplete:"off"},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}})],1)],1),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){return t.stopPropagation(),e.editUserCancel(t)}}},[e._v("\n          Cancel\n        ")]),e._v(" "),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){return t.stopPropagation(),e.editUserConfirm(t)}}},[e._v("\n          Edit\n        ")])],1),e._v(" "),e.editingUser?a("div",{staticClass:"loadingOver"},[a("v-progress-circular",{staticClass:"progress",attrs:{size:"50",width:3,indeterminate:"",color:"primary"}})],1):e._e()],1)],1),e._v(" "),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.userDialog,callback:function(t){e.userDialog=t},expression:"userDialog"}},[a("v-card",[a("v-card-title",[a("h2",[e._v("Add new user")])]),e._v(" "),a("v-card-text",[a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.validNewUserForm,callback:function(t){e.validNewUserForm=t},expression:"validNewUserForm"}},[a("v-text-field",{attrs:{label:"Username",rules:e.usernameRules,counter:10,required:""},model:{value:e.newUsername,callback:function(t){e.newUsername=t},expression:"newUsername"}}),e._v(" "),a("v-text-field",{attrs:{label:"E-mail",rules:e.emailRules,required:""},model:{value:e.newEmail,callback:function(t){e.newEmail=t},expression:"newEmail"}}),e._v(" "),a("v-text-field",{attrs:{type:"password",label:"Password",required:""},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}}),e._v(" "),a("v-select",{attrs:{label:"User role","item-text":"name","item-value":"id",items:e.userRoles,rules:[function(e){return!!e||"Item is required"}],required:""},model:{value:e.newUserRoleID,callback:function(t){e.newUserRoleID=t},expression:"newUserRoleID"}})],1)],1),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){t.stopPropagation(),e.userDialog=!1}}},[e._v("\n          Cancel\n        ")]),e._v(" "),a("v-btn",{attrs:{color:"primary",text:"",disabled:!e.validNewUserForm||""==e.newUsername||""==e.newEmail||""==e.newPassword||""==e.newUserRoleID},on:{click:function(t){return t.stopPropagation(),e.addUser(t)}}},[e._v("\n          Add user\n        ")])],1),e._v(" "),e.addingUser?a("div",{staticClass:"loadingOver"},[a("v-progress-circular",{staticClass:"progress",attrs:{size:"50",width:3,indeterminate:"",color:"primary"}})],1):e._e()],1)],1)],1)},i=[],s={render:n,staticRenderFns:i};t.a=s}});
//# sourceMappingURL=25.3bb6dc17dce010fe5ff2.js.map